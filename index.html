<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Highlight Industries | Contact Update</title>

  <style>
    :root{
      --hi-green:#3F845B;
      --ink:#111;
      --muted:#555;
      --line:#222;
      --soft:#e9e9e9;
      --bg:#ffffff;
      --radius:10px;
      --maxw: 980px;
      --font: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Arial, "Apple Color Emoji","Segoe UI Emoji";
    }
    html,body{ background: var(--bg); color: var(--ink); margin:0; font-family: var(--font); }
    .wrap{ max-width: var(--maxw); margin: 0 auto; padding: 18px clamp(14px, 3vw, 28px) 36px; }

    .header{ border-bottom: 3px solid var(--hi-green); padding-bottom: 10px; }
    .header img{ width:100%; height:auto; display:block; object-fit: contain; max-height: 140px; }

    .titleblock{ text-align:center; margin: 18px 0 14px; }
    .titleblock h1{ font-size: 28px; font-weight: 800; margin: 10px 0 8px; letter-spacing: -0.02em; }
    .titleblock p{ margin: 0 auto; max-width: 90ch; line-height: 1.4; font-size: 14px; }

    .paper{ margin-top: 14px; background: #fff; border: 1px solid var(--soft); border-radius: var(--radius); padding: 18px; }

    .sectionlabel{
      margin: 18px 0 10px; font-weight: 800; letter-spacing: 0.02em;
      display:flex; align-items:center; gap: 10px;
    }
    .sectionlabel::before{
      content:""; width: 10px; height: 10px; border-radius: 50%;
      background: var(--hi-green); box-shadow: 0 0 0 4px rgba(63,132,91,0.18);
      display:inline-block;
    }

    .box{ border: 1px solid var(--line); border-radius: 6px; overflow:hidden; }
    .boxrow{ display:grid; grid-template-columns: 190px 1fr; border-top: 1px solid var(--line); min-height: 44px; }
    .boxrow:first-child{ border-top: none; }
    .boxlabel{ border-right: 1px solid var(--line); padding: 10px 12px; font-weight: 700; font-size: 14px; }
    .boxfield{ padding: 8px 10px; display:flex; align-items:center; }

    input, textarea{
      width:100%; border: none; outline:none; font-size: 14px;
      padding: 8px 6px; background: transparent; color: var(--ink);
    }

    .table{ border: 1px solid var(--line); border-radius: 6px; overflow:hidden; }
    .trow{ display:grid; grid-template-columns: 190px 1fr 1.2fr 0.9fr; border-top: 1px solid var(--line); min-height: 44px; background:#fff; }
    .trow:first-child{ border-top:none; }
    .thead{ background: #f7f7f7; font-weight: 800; }
    .tcell{ border-right: 1px solid var(--line); padding: 8px 10px; display:flex; align-items:center; font-size: 14px; }
    .trow .tcell:last-child{ border-right:none; }
    .role{ font-weight: 700; }

    textarea.comments{ resize: vertical; min-height: 110px; border: 1px solid var(--line); border-radius: 6px; padding: 10px 10px; }

    .actions{
      margin-top: 18px; display:flex; flex-wrap:wrap; gap: 12px;
      align-items:center; justify-content:space-between;
      border-top: 1px solid var(--soft); padding-top: 14px;
    }

    .btn{
      border: 1px solid var(--hi-green); background: var(--hi-green); color: #fff;
      font-weight: 800; border-radius: 10px; padding: 12px 16px; cursor:pointer;
      min-width: 220px; display:inline-flex; align-items:center; justify-content:center; gap: 10px;
      transition: transform 120ms ease, filter 120ms ease;
    }
    .btn:hover{ transform: translateY(-1px); filter: brightness(1.03); }
    .btn:active{ transform: translateY(0px) scale(0.99); }
    .btn[disabled]{ opacity:.6; cursor:not-allowed; transform:none; }

    .spinner{
      width: 16px; height: 16px; border-radius: 999px;
      border: 2px solid rgba(255,255,255,0.45); border-top-color: rgba(255,255,255,1);
      animation: spin 900ms linear infinite; display:none;
    }
    .btn.loading .spinner{ display:inline-block; }
    @keyframes spin{ to{ transform: rotate(360deg);} }

    .note{ color: var(--muted); font-size: 12px; line-height: 1.35; max-width: 80ch; }

    .error{ color: #b00020; font-size: 12px; margin-top: 10px; display:none; }

    .toast{
      position: fixed; bottom: 18px; left: 50%;
      transform: translateX(-50%) translateY(18px);
      background: #111; color: #fff; padding: 12px 14px; border-radius: 12px;
      opacity: 0; pointer-events:none;
      transition: opacity 160ms ease, transform 160ms ease;
      display:flex; align-items:center; gap: 10px;
      max-width: min(640px, calc(100vw - 28px));
      box-shadow: 0 18px 60px rgba(0,0,0,0.25);
    }
    .toast.show{ opacity: 1; transform: translateX(-50%) translateY(0); }
    .okdot{ width:10px; height:10px; border-radius:50%; background: #6ee7b7; }
    .baddot{ width:10px; height:10px; border-radius:50%; background: #ff5a6a; }

    @media (max-width: 760px){
      .boxrow{ grid-template-columns: 1fr; }
      .boxlabel{ border-right:none; border-bottom: 1px solid var(--line); }

      .trow{ grid-template-columns: 1fr; padding: 10px 10px 12px; }
      .thead{ display:none; }
      .tcell{ border-right:none; padding: 6px 0; display:block; }
      .tcell[data-label]::before{
        content: attr(data-label); display:block; font-size: 11px; letter-spacing: 0.10em;
        text-transform: uppercase; color: var(--muted); margin-bottom: 4px;
      }
      .role{ margin-bottom: 6px; }
      .table{ border-radius: 10px; }
      .trow{ border-top: 1px solid var(--soft); }
      .trow:first-child{ border-top:none; }
      .trow{ border-left: 1px solid var(--line); border-right: 1px solid var(--line); }
      .trow:last-child{ border-bottom: 1px solid var(--line); }
    }
  </style>
</head>

<body>
  <div class="wrap">
    <div class="header">
      <img src="logo.png" alt="Highlight Industries, Inc." />
    </div>

    <div class="titleblock">
      <h1>Contact Update Form</h1>
      <p>This information will be used to provide updates to the key people in your company. You can add additional contacts below.</p>
    </div>

    <main class="paper">
      <form id="contactForm" novalidate>
        <div class="sectionlabel">Company Information</div>
        <div class="box" aria-label="Company details">
          <div class="boxrow">
            <div class="boxlabel">Company Name:</div>
            <div class="boxfield"><input id="companyName" name="companyName" autocomplete="organization" required /></div>
          </div>
          <div class="boxrow">
            <div class="boxlabel">Street Address:</div>
            <div class="boxfield"><input id="street" name="street" autocomplete="street-address" required /></div>
          </div>
          <div class="boxrow">
            <div class="boxlabel">City:</div>
            <div class="boxfield"><input id="city" name="city" autocomplete="address-level2" required /></div>
          </div>
          <div class="boxrow">
            <div class="boxlabel">State:</div>
            <div class="boxfield"><input id="state" name="state" maxlength="2" placeholder="MI" autocomplete="address-level1" required /></div>
          </div>
          <div class="boxrow">
            <div class="boxlabel">Zip Code:</div>
            <div class="boxfield"><input id="zip" name="zip" inputmode="numeric" autocomplete="postal-code" required /></div>
          </div>
        </div>

        <div class="sectionlabel" style="margin-top:22px;">Key Contacts</div>
        <div class="table" role="group" aria-label="Key contacts table">
          <div class="trow thead" aria-hidden="true">
            <div class="tcell">Role</div><div class="tcell">Name</div><div class="tcell">Email</div><div class="tcell">Phone</div>
          </div>

          <div class="trow">
            <div class="tcell role" data-label="Role">Sales Manager</div>
            <div class="tcell" data-label="Name"><input name="Sales Manager - Name" autocomplete="name" /></div>
            <div class="tcell" data-label="Email"><input name="Sales Manager - Email" autocomplete="email" inputmode="email" /></div>
            <div class="tcell" data-label="Phone"><input name="Sales Manager - Phone" autocomplete="tel" inputmode="tel" /></div>
          </div>

          <div class="trow">
            <div class="tcell role" data-label="Role">Service Manager</div>
            <div class="tcell" data-label="Name"><input name="Service Manager - Name" autocomplete="name" /></div>
            <div class="tcell" data-label="Email"><input name="Service Manager - Email" autocomplete="email" inputmode="email" /></div>
            <div class="tcell" data-label="Phone"><input name="Service Manager - Phone" autocomplete="tel" inputmode="tel" /></div>
          </div>

          <div class="trow">
            <div class="tcell role" data-label="Role">General Manager</div>
            <div class="tcell" data-label="Name"><input name="General Manager - Name" autocomplete="name" /></div>
            <div class="tcell" data-label="Email"><input name="General Manager - Email" autocomplete="email" inputmode="email" /></div>
            <div class="tcell" data-label="Phone"><input name="General Manager - Phone" autocomplete="tel" inputmode="tel" /></div>
          </div>

          <div class="trow">
            <div class="tcell role" data-label="Role">General Administration</div>
            <div class="tcell" data-label="Name"><input name="General Administration - Name" autocomplete="name" /></div>
            <div class="tcell" data-label="Email"><input name="General Administration - Email" autocomplete="email" inputmode="email" /></div>
            <div class="tcell" data-label="Phone"><input name="General Administration - Phone" autocomplete="tel" inputmode="tel" /></div>
          </div>

          <div class="trow">
            <div class="tcell role" data-label="Role">Accounts Payable</div>
            <div class="tcell" data-label="Name"><input name="Accounts Payable - Name" autocomplete="name" /></div>
            <div class="tcell" data-label="Email"><input name="Accounts Payable - Email" autocomplete="email" inputmode="email" /></div>
            <div class="tcell" data-label="Phone"><input name="Accounts Payable - Phone" autocomplete="tel" inputmode="tel" /></div>
          </div>

          <div class="trow">
            <div class="tcell role" data-label="Role">Equipment Specialist</div>
            <div class="tcell" data-label="Name"><input name="Equipment Specialist - Name" autocomplete="name" /></div>
            <div class="tcell" data-label="Email"><input name="Equipment Specialist - Email" autocomplete="email" inputmode="email" /></div>
            <div class="tcell" data-label="Phone"><input name="Equipment Specialist - Phone" autocomplete="tel" inputmode="tel" /></div>
          </div>

          <div class="trow">
            <div class="tcell role" data-label="Role">Purchasing Manager</div>
            <div class="tcell" data-label="Name"><input name="Purchasing Manager - Name" autocomplete="name" /></div>
            <div class="tcell" data-label="Email"><input name="Purchasing Manager - Email" autocomplete="email" inputmode="email" /></div>
            <div class="tcell" data-label="Phone"><input name="Purchasing Manager - Phone" autocomplete="tel" inputmode="tel" /></div>
          </div>

          <div class="trow">
            <div class="tcell role" data-label="Role">Additional Contact 1</div>
            <div class="tcell" data-label="Name"><input name="Additional Contact 1 - Name" autocomplete="name" /></div>
            <div class="tcell" data-label="Email"><input name="Additional Contact 1 - Email" autocomplete="email" inputmode="email" /></div>
            <div class="tcell" data-label="Phone"><input name="Additional Contact 1 - Phone" autocomplete="tel" inputmode="tel" /></div>
          </div>

          <div class="trow">
            <div class="tcell role" data-label="Role">Additional Contact 2</div>
            <div class="tcell" data-label="Name"><input name="Additional Contact 2 - Name" autocomplete="name" /></div>
            <div class="tcell" data-label="Email"><input name="Additional Contact 2 - Email" autocomplete="email" inputmode="email" /></div>
            <div class="tcell" data-label="Phone"><input name="Additional Contact 2 - Phone" autocomplete="tel" inputmode="tel" /></div>
          </div>

          <div class="trow">
            <div class="tcell role" data-label="Role">Additional Contact 3</div>
            <div class="tcell" data-label="Name"><input name="Additional Contact 3 - Name" autocomplete="name" /></div>
            <div class="tcell" data-label="Email"><input name="Additional Contact 3 - Email" autocomplete="email" inputmode="email" /></div>
            <div class="tcell" data-label="Phone"><input name="Additional Contact 3 - Phone" autocomplete="tel" inputmode="tel" /></div>
          </div>
        </div>

        <div class="sectionlabel" style="margin-top:22px;">Comments</div>
        <textarea class="comments" id="comments" name="Comments"></textarea>

        <div class="actions">
          <button id="submitBtn" class="btn" type="submit">
            <span class="spinner" aria-hidden="true"></span>
            <span class="btntext">Submit Contact Update</span>
          </button>

          <div class="note">
            If you have questions, call <strong>616-531-2464</strong> or email
            <strong>jessicaf@highlightindustries.com</strong>.
          </div>
        </div>

        <div class="error" id="errorBox"></div>
      </form>
    </main>
  </div>

  <div class="toast" id="toast" role="status" aria-live="polite">
    <span class="okdot" id="toastDot"></span>
    <div id="toastMsg">Saved!</div>
  </div>

  <script>
    // 1) Paste your NEW deployed Apps Script Web App URL (must end with /exec)
    const APPS_SCRIPT_WEB_APP_URL = "https://script.google.com/macros/s/AKfycbwFM5XyUFIUXc3tRz98VVmd3oYi2RaJKbT5707OyBQ4ydyPeP9kTrALU6fkPjfxabEKGA/exec";

    const form = document.getElementById("contactForm");
    const btn = document.getElementById("submitBtn");
    const errorBox = document.getElementById("errorBox");
    const toast = document.getElementById("toast");
    const toastMsg = document.getElementById("toastMsg");
    const toastDot = document.getElementById("toastDot");

    const showToast = (msg, ok=true) => {
      toastMsg.textContent = msg;
      toastDot.className = ok ? "okdot" : "baddot";
      toast.classList.add("show");
      window.clearTimeout(showToast._t);
      showToast._t = window.setTimeout(() => toast.classList.remove("show"), 3200);
    };

    const setLoading = (loading) => {
      btn.disabled = loading;
      btn.classList.toggle("loading", loading);
    };

    const validateBasics = () => {
      errorBox.style.display = "none";
      errorBox.textContent = "";

      const companyName = (form.companyName.value || "").trim();
      const street = (form.street.value || "").trim();
      const city = (form.city.value || "").trim();
      const state = (form.state.value || "").trim();
      const zip = (form.zip.value || "").trim();

      const errs = [];
      if (!companyName) errs.push("Company Name is required.");
      if (!street) errs.push("Street Address is required.");
      if (!city) errs.push("City is required.");
      if (!state || state.length !== 2) errs.push("State must be a 2-letter code (ex: MI).");
      if (!zip) errs.push("Zip Code is required.");

      const emailInputs = form.querySelectorAll('input[name$="Email"]');
      const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
      emailInputs.forEach(inp => {
        const v = (inp.value || "").trim();
        if (v && !emailRegex.test(v)) errs.push(`Please check email format: "${v}"`);
      });

      if (errs.length){
        errorBox.textContent = errs.join(" ");
        errorBox.style.display = "block";
        showToast("Please fix the items above.", false);
        return false;
      }
      return true;
    };

    const formToObject = () => {
      const data = {};
      const fd = new FormData(form);
      fd.forEach((value, key) => { data[key] = String(value).trim(); });
      data.state = (data.state || "").toUpperCase();
      data.timestamp = new Date().toISOString();
      data._page = location.href;
      return data;
    };

    form.addEventListener("submit", async (e) => {
      e.preventDefault();
      if (!validateBasics()) return;

      if (!APPS_SCRIPT_WEB_APP_URL || APPS_SCRIPT_WEB_APP_URL.includes("PASTE_YOUR_WEB_APP_EXEC_URL_HERE")){
        errorBox.textContent = "Setup needed: paste your deployed Apps Script Web App URL (ends with /exec) into APPS_SCRIPT_WEB_APP_URL.";
        errorBox.style.display = "block";
        showToast("Missing Apps Script URL.", false);
        return;
      }

      setLoading(true);
      const payload = formToObject();

      try{
        // Use text/plain to avoid preflight headaches
        await fetch(APPS_SCRIPT_WEB_APP_URL, {
          method: "POST",
          mode: "no-cors",
          headers: { "Content-Type": "text/plain;charset=utf-8" },
          body: JSON.stringify(payload)
        });

        showToast("Submitted! Thank you — we’ve received your update.");
        form.reset();
      }catch(err){
        console.error(err);
        errorBox.textContent = "Submission failed. Please try again.";
        errorBox.style.display = "block";
        showToast("Submission failed.", false);
      }finally{
        setLoading(false);
      }
    });
  </script>
</body>
</html>
